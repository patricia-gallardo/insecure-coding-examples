# -----------------------------------------------------------------
#
# EXPLOITABLE
#
# -----------------------------------------------------------------

# CWE 124 : BUFFER UNDERFLOW
add_executable(buffer_underflow buffer_underflow.c)

# CWE 416 : USE AFTER FREE - string_view
add_executable(dangling_pointer dangling_pointer.cpp)
target_compile_features(dangling_pointer PRIVATE cxx_std_17)

# CWE 14 : DISAPPEARING MEMSET
add_executable(disappearing_memset disappearing_memset.c)
target_compile_options(disappearing_memset PRIVATE -O3)

# CWE 415 : DOUBLE FREE
add_executable(double_free double_free.c)

# CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
add_executable(global_buffer_overflow global_buffer_overflow.c)

# CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
add_executable(container_overflow container_overflow.cpp)

# CWE 122 : HEAP BUFFER OVERFLOW
add_executable(heap_buffer_overflow heap_buffer_overflow.c)

# CWE 122 : HEAP BUFFER OVERFLOW
add_executable(heap_buffer_overflow_cwe heap_buffer_overflow_cwe.c)

# CWE 704 : INCORRECT TYPE CONVERSION
add_executable(incorrect_type_conversion incorrect_type_conversion.cpp)

# INFINITE LOOP CPP
add_executable(infinite_loop_cpp infinite_loop.cpp)
target_compile_options(infinite_loop_cpp PRIVATE -O3 -Waggressive-loop-optimizations)

# CWE 197 : NUMERIC TRUNCATION
add_executable(numeric_truncation numeric_truncation.c)
add_executable(numeric_truncation_ubsan numeric_truncation_ubsan.c)
add_executable(numeric_truncation_unsafe numeric_truncation_unsafe.c)

# CWE 190 : SIGNED INTEGER OVERFLOW
add_executable(signed_integer_overflow signed_integer_overflow.c)
add_executable(signed_integer_overflow_ubsan signed_integer_overflow_ubsan.c)
add_executable(signed_integer_overflow_unsafe signed_integer_overflow_unsafe.c)

# CWE 121 & CWE 242 : STACK BUFFER OVERFLOW
add_executable(stack_buffer_overflow stack_buffer_overflow.c)
set_property(TARGET stack_buffer_overflow PROPERTY C_STANDARD 99)
target_compile_options(stack_buffer_overflow PRIVATE -Wno-deprecated-declarations)

# CWE 121 : STACK BUFFER OVERFLOW
add_executable(stack_buffer_overflow_cwe stack_buffer_overflow_cwe.c)

# CWE 416 : USE AFTER FREE
add_executable(temporary_capture temporary_capture.cpp)

# CWE-134 : Use of Externally-Controlled Format String
add_executable(uncontrolled_format_string uncontrolled_format_string.c)

# UNNAMED LOCK GUARD
add_executable(unnamed_lock_guard unnamed_lock_guard.cpp)
target_compile_features(unnamed_lock_guard PRIVATE cxx_std_17)

# CWE 190 : UNSIGNED INTEGER WRAPAROUND
add_executable(unsigned_integer_wraparound unsigned_integer_wraparound.c)
add_executable(unsigned_integer_wraparound_ubsan unsigned_integer_wraparound_ubsan.c)
add_executable(unsigned_integer_wraparound_unsafe unsigned_integer_wraparound_unsafe.c)

# CWE 416 : USE AFTER FREE
add_executable(use_after_free use_after_free.c)

# COMPILER OPTIMIZATIONS OF UNDEFINED BEHAVIOR
add_executable(undefined_behavior undefined_behavior.cpp)
target_compile_options(undefined_behavior PRIVATE -Wno-overflow)
